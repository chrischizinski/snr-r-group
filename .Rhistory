blogdown:::serve_site()
source('http://openmx.psyc.virginia.edu/getOpenMx.R')
install.packages('semTools')
library(semTools)
measurementInvarianceCat(fit)
library(lavaan)
library(tidyverse)
grouse.model2 <- ' scenary  =~ outdoors + nature  + solitude
social =~ hunt_fam + hunt_friends  + relax_fam + relax_friend + meet_ppl + tradition
competition   =~ comp_mates + comp_team  + bag + trapshoot + showoff + grouse_chall
hunting =~  hunt_sharp + hunt_chick + hunt_hab'
fit <-  cfa(grouse.model2, data = motivations, std.lv = TRUE, missing = "fiml")
sht_data <- read_csv("/Volumes/g1$/HumanDimensions/Alisha/Data/Sharptail_Shootout.csv")
sht_data %>%
select(Q4a:Q4s)  %>%
rename(outdoors = Q4a,
nature = Q4b,
hunt_fam = Q4c,
hunt_friends = Q4d,
solitude = Q4e,
relax_fam = Q4f,
relax_friend = Q4g,
comp_team = Q4h,
comp_mates = Q4i,
grouse_chall = Q4j,
bag = Q4k,
meet_ppl = Q4l,
tradition = Q4m,
qual_accom = Q4n,
showoff = Q4o,
trapshoot = Q4p,
hunt_sharp = Q4q,
hunt_chick = Q4r,
hunt_hab = Q4s)-> motivations
fit <-  cfa(grouse.model2, data = motivations, std.lv = TRUE, missing = "fiml")
summary(fit, fit.measure = TRUE, standardized = TRUE)
measurementInvarianceCat(fit)
?measurementInvarianceCat
measurementInvarianceCat(grouse.model2,)
measurementInvarianceCat(grouse.model2,data = motivations)
data(datCat)
head(datCat)
?reliability
reliability(fit)
summary(fit, fit.measure = TRUE, standardized = TRUE)
?cfa
modificationindices(fit, sort.=TRUE, minimum.value = 3)
summary(fit, fit.measure = TRUE, standardized = TRUE)
?cfa
parameterEstimates(fit, standardized = TRUE)
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs)
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = est), colour = "white", size = 12)
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs)
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs,
pvalue <= 0.05) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs,
pvalue <= 0.05) %>%
complete(lhs, nesting(rhs))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting'),
lhs!=rhs) %>%
complete(lhs, nesting(rhs))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", fill = "6F1E26") +
labs( y = "Cohort", x ="Years since") +
scale_y_reverse() +
theme_minimal() +
theme(axis.title = element_text(size = 32, colour = "black", vjust = 1),
axis.text = element_text(size = 26, colour = "black", hjust = 1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", fill = "6F1E26")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", na.fill = "6F1E26") +
labs( y = "Cohort", x ="Years since") +
scale_y_reverse() +
theme_minimal() +
theme(axis.title = element_text(size = 32, colour = "black", vjust = 1),
axis.text = element_text(size = 26, colour = "black", hjust = 1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", na.fill = "6F1E26")
?scale_fill_continuous
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", na.value = "6F1E26")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#4a1486", high = "#bcbddc", na.value = "#6F1E26")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
theme_presentation()
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
theme_presentation()
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation()
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(panel.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "black") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26", colour = "white"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est),
lhs = gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", lhs, perl=TRUE)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est),
lhs = gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", lhs, perl=TRUE),
rhs = gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", rhs, perl=TRUE)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
png("sampleplot.png", bg = "transparent")
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
lhs %in% c('scenary', 'social','competition', 'hunting')) %>%
complete(lhs, nesting(rhs)) %>%
mutate(est = ifelse(pvalue>0.05,NA, est),
lhs = gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", lhs, perl=TRUE),
rhs = gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", rhs, perl=TRUE)) %>%
ggplot() +
geom_tile(aes(x = lhs, y = rhs, fill = est), colour = "white") +
geom_text(aes(x =  lhs, y = rhs, fill = est, label = round(est,digits =2)), colour = "white", size = 12) +
scale_fill_continuous(low = "#08306b", high = "#6baed6", na.value = "#6F1E26") +
scale_x_discrete(expand = c(0,0)) +
scale_y_discrete(expand = c(0,0)) +
labs(y = "Latent variable", x = "Latent variable") +
theme_presentation() +
theme(plot.background = element_rect(fill = "#6F1E26"),
legend.position = "none")
dev.off()
getwd()
?png
l
reliability(fit)
parameterEstimates(fit, standardized = TRUE)
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~~",
rhs %in% c('scenary', 'social','competition', 'hunting'))
parameterEstimates(fit, standardized = TRUE) %>%
filter(op == "~.",
rhs %in% c('scenary', 'social','competition', 'hunting'))
parameterEstimates(fit, standardized = TRUE)
motivations %>%
summarise_all( mean, na.rm = TRUE) %>%
gather()
motivations %>%
summarise_all( mean, na.rm = TRUE) %>%
gather() %>%
arrange(desc(value))
motivations %>%
summarise_all( mean, na.rm = TRUE)
