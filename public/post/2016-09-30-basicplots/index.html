<!DOCTYPE html>
<html lang="en-us">
    <head>
         
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Plotting</title>
        <style>

    html body {
        font-family: 'Roboto', sans-serif;
        background-color: #FEFDFA;
    }

    :root {
        --accent: #D00000;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/hybrid.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/kotlin.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/swift.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script> 

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.30.2" />
        
        
        
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-48496439-3"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments)};
          gtag('js', new Date());

          gtag('config', 'UA-48496439-3');
        </script>
        
    </head>

    
    
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <body>
         
        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">Plotting</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/resources/">Resources</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:cchizinski2@unl.edu"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/chrischizinski/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/chrischizinski/"><i class="fa fa-twitter"></i></a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>


<main>

    <div class="item">

    
    
    

    
    

    <h4><a href="/post/2016-09-30-basicplots/">Plotting</a></h4>
    <h5>September 30, 2016</h5>
    
    <a href="/tags/basics"><kbd class="item-tag">Basics</kbd></a>
    
    <a href="/tags/graphics"><kbd class="item-tag">Graphics</kbd></a>
    

</div>


    <br> <div class="text-justify"><div id="basic-plotting-in-ggplot" class="section level2">
<h2>Basic plotting in ggplot</h2>
<p>ggplot is a package that has truly upped the level of producing quality graphics using R. The “g g” in ggplot refers to the grammar of graphics. There has been a lot of development of the theory in what makes a good plot and I encourage you to read more on the <a href="http://vita.had.co.nz/papers/layered-grammar.pdf">subject</a>.</p>
<p>From the <a href="http://ggplot2.org/">ggplot2 website</a></p>
<blockquote>
<p>ggplot2 is a plotting system for R, based on the grammar of graphics, which tries to take the good parts of base and lattice graphics and none of the bad parts. It takes care of many of the fiddly details that make plotting a hassle (like drawing legends) as well as providing a powerful model of graphics that makes it easy to produce complex multi-layered graphics.</p>
</blockquote>
<p>The components of a plot are:</p>
<ul>
<li>data and aesthetic mappings,</li>
<li>geometric objects,</li>
<li>scales,</li>
<li>facet specification,</li>
<li>statistical transformations, and</li>
<li>the coordinate system.</li>
</ul>
<p>Plots using <code>ggplot()</code> are made in a series of layers. Each layer is composed of:</p>
<ul>
<li>data and aesthetic mappings,</li>
<li>a statistical transformation (stat),</li>
<li>a geometric object (geom), and</li>
<li>a position adjustment</li>
</ul>
<p>There are a <strong>TON</strong> of options for plots in <code>ggplot</code> and I can not cover them all here. Everything from plotting shapefiles to violin plots. I will provide you the basics, but most are going to require you to look at the website and test out the types of plots you interested in. I strongly encourage you to explore and test out the different types of plots.</p>
<p>To begin and explore ggplot, we will use the <code>diamonds</code> data set.</p>
<pre class="r"><code>#install.packages(&quot;tidyverse&quot;)
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ──── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.8.0     ✔ stringr 1.3.0
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ─────── tidyverse_conflicts() ──
## ✖ readr::col_factor() masks scales::col_factor()
## ✖ purrr::discard()    masks scales::discard()
## ✖ dplyr::filter()     masks stats::filter()
## ✖ dplyr::lag()        masks stats::lag()</code></pre>
<pre class="r"><code>data(diamonds)
head(diamonds)</code></pre>
<pre><code>## # A tibble: 6 x 10
##   carat cut       color clarity depth table price     x     y     z
##   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 0.230 Ideal     E     SI2      61.5   55.   326  3.95  3.98  2.43
## 2 0.210 Premium   E     SI1      59.8   61.   326  3.89  3.84  2.31
## 3 0.230 Good      E     VS1      56.9   65.   327  4.05  4.07  2.31
## 4 0.290 Premium   I     VS2      62.4   58.   334  4.20  4.23  2.63
## 5 0.310 Good      J     SI2      63.3   58.   335  4.34  4.35  2.75
## 6 0.240 Very Good J     VVS2     62.8   57.   336  3.94  3.96  2.48</code></pre>
<p>A couple of points to consider and keep in mind:</p>
<ul>
<li>Data needs to be in data.frame.<br />
</li>
<li>Layers are separated by <code>+</code></li>
<li>Plots can be saved as objects</li>
</ul>
<p>There are several ways we can specify data in ggplot. By specifying it in the top of the hierarchy (i.e., in <code>ggplot()</code>), then all the subsequent layers will use this data set. My personal feeling is to specify it in the layers so that it is clear which data you are using. I feel the same way about the aesthetics as well, but sometimes this it is required to put them in the top (i.e., <code>position_dodge()</code> and error bars)</p>
<pre class="r"><code>ggplot(data = diamonds,aes(x=carat, y=price)) +
  geom_point()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>#or

ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<p>We have lots of options of the aesthetics when we are building the plots. The required aesthetics will depend on the geometry chosen. There are numerous geometries <a href="http://docs.ggplot2.org/current/">available</a>.</p>
<p>Common aesthetics:</p>
<ul>
<li><code>x</code>: the x coordinates of the data that you wish to plot. Can be numeric or categorical.</li>
<li><code>y</code>: the y-coordinates of the data that you wish to plot.</li>
<li><code>color</code> or <code>colour</code>: the color of points, lines, or edges. Colors can be specified using any of the <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">R colors</a></li>
<li><code>fill</code>: similar to color but this specifies the fill of of polygons, bars, or other shapes.</li>
<li><code>size</code>: the size of the points or the thickness of the line</li>
<li><code>shape</code>: used in geom_point to specify the <a href="http://www.cookbook-r.com/Graphs/Shapes_and_line_types/">different points</a></li>
<li><code>linetype</code>: the type of line to be plotted <a href="http://www.cookbook-r.com/Graphs/Shapes_and_line_types/">(e.g., <code>solid</code>, <code>dashed</code>, <code>dotted</code>)</a></li>
<li><code>alpha</code>: the transparency level of the layer</li>
</ul>
<p>When we put these on the <strong>outside</strong> the aesthetic statement <code>aes()</code>, all points are treated the same.</p>
<pre class="r"><code>#color
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price), colour =&quot;dodgerblue&quot;)</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>#shape
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price), colour =&quot;dodgerblue&quot;, shape = 17)</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code>#size
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price), colour =&quot;dodgerblue&quot;, shape = 17, size =5)</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<pre class="r"><code>#alpha
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price), colour =&quot;dodgerblue&quot;, shape = 17, size =5, alpha = 0.25)</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<p>When we put these on the <strong>inside</strong> the aesthetic statement <code>aes()</code>, points are treated differently based on the <strong>level</strong> of the variable. These are then given a value in a legend. Numeric values are given a continuous scale and characters or factors are given a discrete scale.</p>
<pre class="r"><code>#color
#numeric
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price, colour=carat))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>#factor
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price, colour=cut))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>#shape
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price, colour=carat, shape = cut))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<pre class="r"><code>#size
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price, colour=carat,size = carat))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-4-4.png" width="672" /></p>
<pre class="r"><code>#alpha
ggplot() +
  geom_point(data = diamonds,aes(x=carat, y=price, colour=carat, alpha = carat))</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-4-5.png" width="672" /></p>
<div id="bar-plots" class="section level3">
<h3>Bar plots</h3>
<p>Start by making some data</p>
<pre class="r"><code>fake_data = data.frame(Type = rep(c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;),  each = 30),
                       Value = c(rnorm(30, mean = 50, sd = 5),
                                 rnorm(30, mean = 70, sd = 3),
                                 rnorm(30, mean = 20, sd = 8)))

fake_data_sum &lt;- fake_data %&gt;% 
                  group_by(Type) %&gt;% 
                  summarise(M_val = mean(Value),
                            SE_val = sd(Value)/sqrt(length(Value))) %&gt;% 
                  mutate(CI_lo = M_val - 1.96 * SE_val,
                         CI_hi = M_val + 1.96 * SE_val)</code></pre>
<pre class="r"><code>ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val), stat = &quot;identity&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<p>We can control how these values are presented by using the <a href="http://docs.ggplot2.org/current/index.html">scale commands</a></p>
<pre class="r"><code># manual
ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;, colour = &quot;black&quot;) + 
  scale_fill_manual(values = c(&quot;A&quot; = &quot;red&quot;, &quot;B&quot; = &quot;blue&quot;, &quot;C&quot; = &quot;green&quot;)) +
  labs(x = &quot;Type&quot;, y = &quot;Value&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># color brewer [http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3]
ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;, colour = &quot;black&quot;) + 
  scale_fill_brewer(palette = &quot;Spectral&quot;) +
  labs(x = &quot;Type&quot;, y = &quot;Value&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
</div>
</div>
<div id="controlling-axes" class="section level2">
<h2>Controlling axes</h2>
<pre class="r"><code>ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;, colour = &quot;black&quot;) + 
  scale_fill_brewer(palette = &quot;Spectral&quot;) +
  scale_y_continuous(limits = c(0, 40)) +
  labs(x = &quot;Type&quot;, y = &quot;Value&quot;) + 
  theme_bw()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (position_stack).</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;, colour = &quot;black&quot;) + 
  scale_fill_brewer(palette = &quot;Spectral&quot;) +
  coord_cartesian(ylim = c(0, 30)) +
  labs(x = &quot;Type&quot;, y = &quot;Value&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>Notice the difference between these plots. <code>scale_y_continuous</code> drops out the bars greater than thelimit set, whereas <code>coord_cartesian</code> keeps the bars but displays limits. Keep that in mind when using these. I tend to always use <code>coord_cartesian</code> and only use <code>scale_y_continuous</code> to set my breaks.</p>
<p>One of the things, that I really dislike about the default <code>ggplot</code> is the pretty spaces that are put into the plots. You can get rid of these using <code>expand = FALSE</code> in <code>coord_cartesian</code>.</p>
<pre class="r"><code>ggplot() + 
  geom_bar(data = fake_data_sum, aes(x = Type, y = M_val, fill = Type), stat = &quot;identity&quot;, colour = &quot;black&quot;) + 
  scale_fill_brewer(palette = &quot;Spectral&quot;) +
  coord_cartesian(ylim = c(0, 75), xlim = c(0.25,3.75), expand = FALSE) +
  labs(x = &quot;Type&quot;, y = &quot;Value&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/2016-09-30-BasicPlots_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>

    
    

    

        <h4 class="page-header">Related</h4>

         <div class="item">

    
    
    

    
    

    <h4><a href="/post/2017-09-08-introtoggplot2/">Intro to ggplot2</a></h4>
    <h5>September 8, 2017</h5>
    
    <a href="/tags/applied-multivariate"><kbd class="item-tag">Applied Multivariate</kbd></a>
    
    <a href="/tags/basics"><kbd class="item-tag">Basics</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2017-09-01-introtodatawrangling/">Intro to Data Wrangling</a></h4>
    <h5>September 1, 2017</h5>
    
    <a href="/tags/applied-multivariate"><kbd class="item-tag">Applied Multivariate</kbd></a>
    
    <a href="/tags/basics"><kbd class="item-tag">Basics</kbd></a>
    

</div>
  <div class="item">

    
    
    

    
    

    <h4><a href="/post/2017-08-25-introtor/">Getting to know R -- yet again</a></h4>
    <h5>August 25, 2017</h5>
    
    <a href="/tags/applied-multivariate"><kbd class="item-tag">Applied Multivariate</kbd></a>
    
    <a href="/tags/basics"><kbd class="item-tag">Basics</kbd></a>
    

</div>
 

    

    

        <h4 class="page-header">Comments</h4>

        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "snrrgroup" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    

</main>

        <footer>

            <p class="copyright text-muted">&copy; All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a></p>

        </footer>
       
    </body>

</html>

